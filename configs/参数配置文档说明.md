# 配置文件参数说明

本文档以 `configs/rec/crnn/crnn_resnet34.yaml` 为例，详细说明参数的用途。


## 1. 训练环境参数 (system)


| 字段 | 用途 | 默认值 | 可选值 | 备注 |
| ---- | ---- | ---- | ---- | ---- |
| mode | 设置运行编译模式 | 0 | 0: 表示在GRAPH_MODE模式中运行; 1: PYNATIVE_MODE模式 | \ |
| distribute | 设置是否开启并行训练 | True | True / False | \ |
| amp_level | 设置混合精度模式 | O0 | O0/O1/O2/O3 | 'O0' - 不变化。<br> 'O1' - 将白名单内的Cell和运算转为float16精度，其余部分保持float32精度。<br> 'O2' - 将黑名单内的Cell和运算保持float32精度，其余部分转为float16精度。<br> 'O3' - 将网络全部转为float16精度。|
| seed | 随机算子 | 42 | Integer | \ |
| val_while_train | 是否开启边训练边评估模式 | True | True/False | 如果值为True，请同步配置eval数据集 |
| drop_overflow_update | 出现溢出时，是否执行优化器 | True | True/False | 如果值为True，则出现溢出时不会执行优化器 |


## 2. 通用参数 (common)

因为同一个参数可能在不同的配置部分都需要重复利用，所以您可以在这个部分自定义一些通用的参数，以便管理。


## 3. 模型架构 (model)

在MindOCR中，模型的网络架构划分为 Transform, Backbone, Neck和Head四个部分。以下是各部分的配置说明与例子：

| 字段 | 用途 | 例子 | 备注 |
| :---- | :---- | :---- | :---- |
| type | 网络类型 | rec | 目前支持 rec/det; rec表示识别任务，det表示检测任务 |
| **transform**| 配置变换方式 ||
| name | 变换方式名字 | - | 该部分仍在开发，敬请期待 |
| **backbone** | 配置骨干网络 |  详细请参阅[Backbone文档](mindocr\models\README.md)  ||
| name | 骨干网络类名 | rec_resnet34 | 目前已定义的类有 rec_resnet34, rec_vgg7 及 det_resnet50. 亦可自定义新的类别，请参照[Backbone文档](mindocr\models\README.md)指示定义。 |
| pretrained | 是否使用预训练模型 | False | \ |
| **neck** | 配置网络Neck | 详细请参阅[Neck文档](mindocr\models\README.md) ||
| name | Neck类名 | RNNEncoder | 目前已定义的类有 RNNEncoder 及 DBFPN. 亦可自定义新的类别，请参照[Neck文档](mindocr\models\README.md)指示定义。 |
| hidden_size | RNN隐藏层单元数 | 256 | \ |
| **head** | 设置网络预测头 ||
| name | Head类名 | CTCHead | 目前支持CTCHead, DBHead |
| weight_init | 设置权重初始化 | crnn_customised | 自定义的初始化函数，默认是'normal'分布 |
| bias_init | 设置权偏差初始化 | crnn_customised | 自定义的初始化函数，默认是'zeros'|
| out_channels | 设置分类数 | 37 | \ |


## 4. 后处理 (postprocess)

详情请看 [mindocr/postprocess](mindocr\postprocess)

| 字段 | 用途 | 例子 | 备注 |
| :---- | :---- | :---- | :---- |
| name | 后处理类名 | RecCTCLabelDecode | 目前支持 DBPostprocess, RecCTCLabelDecode |
| character_dict_path | 识别字典路径 | mindocr/utils/dict/en_dict.txt | 默认为None, 则使用默认字典[0-9a-z] |
| use_space_char | 设置是否添加空格到字典 | False | True/False | 


## 5. 评估指标 (metric)

详情请看 [mindocr/metrics](mindocr\metrics)

| 字段 | 用途 | 例子 | 备注 |
| :---- | :---- | :---- | :---- |
| name | 评估指标类名 | RecMetric | 目前支持 RecMetric, DetMetric | 
| main_indicator | 主要指标，用于最优模型的比较 | acc | 识别任务用acc，检测任务f-score |
| character_dict_path | 识别字典路径 | mindocr/utils/dict/en_dict.txt | 默认为None, 则使用默认字典[0-9a-z] |
| ignore_space | 是否过滤空格 | True | True/False |
| print_flag | 是否打印log | False | 如设置True，则输出预测结果和标准答案等信息 |


## 6. 损失函数 (loss)

详情请看 [mindocr/losses](mindocr\losses)

| 字段 | 用途 | 例子 | 备注 |
| :---- | :---- | :---- | :---- |
| name | 评估指标类名 | CTCLoss | 目前支持 CTCLoss, L1BalancedCELoss |
| pred_seq_len | 预测文本的长度 | 25 | 由网络架构决定 |
| max_label_len | 最长标签长度 | 24 | 数值小于网络预测文本的长度 |
| batch_size | 单卡批量大小 | 64 | \ |


## 7. 学习率调整策略和优化器 (scheduler, optimizer, loss_scaler)

### 学习率调整策略 (scheduler)

详情请看 [mindocr/scheduler](mindocr\scheduler)

| 字段 | 用途 | 例子 | 备注 |
| :---- | :---- | :---- | :---- |


### 优化器 (optimizer)

### 损失缩放系数 (loss_scaler)

## 8. 训练流程 (train)


## 9. 评估流程 (eval)